<div class="container mx-auto px-4 py-8">
  <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
    <!-- Filters Sidebar -->
    <aside class="lg:col-span-1 bg-surface-light dark:bg-surface-dark p-6 rounded-lg self-start">
      <h2 class="text-xl font-bold mb-6">{{ 'court-search.filters' | translate }}</h2>
      <div class="space-y-6">
        <!-- Sport Filter -->
        <div>
          <label 
            class="block text-sm font-medium text-subtle-light dark:text-subtle-dark mb-2" 
            for="sport">
            {{ 'court-search.sport' | translate }}
          </label>
          <select 
            class="w-full bg-background-light dark:bg-background-dark border border-surface-dark/20 dark:border-surface-dark rounded-lg h-12 px-4 focus:ring-primary focus:border-primary"
            id="sport"
            [value]="filters().sport"
            (change)="onSportChange($any($event.target).value)">
            <option value="tennis">{{ 'sport.tennis' | translate }}</option>
            <option value="padel">{{ 'sport.padel' | translate }}</option>
            <option value="basketball">{{ 'sport.basketball' | translate }}</option>
          </select>
        </div>

        <!-- Location Filter -->
        <div>
          <label 
            class="block text-sm font-medium text-subtle-light dark:text-subtle-dark mb-2" 
            for="location">
            {{ 'court-search.location' | translate }}
          </label>
          <div class="relative">
            <input 
              class="w-full bg-background-light dark:bg-background-dark border border-surface-dark/20 dark:border-surface-dark rounded-lg h-12 px-4 pr-10 focus:ring-primary focus:border-primary"
              id="location"
              type="text"
              [value]="filters().location"
              (input)="onLocationChange($any($event.target).value)"
              [placeholder]="'court-search.location-placeholder' | translate"/>
            <span class="material-symbols-outlined absolute right-3 top-1/2 -translate-y-1/2 text-subtle-light dark:text-subtle-dark">
              my_location
            </span>
          </div>
        </div>

        <!-- Price Range Filter -->
        <div>
          <label 
            class="block text-sm font-medium text-subtle-light dark:text-subtle-dark mb-2" 
            for="price">
            {{ 'court-search.price-range' | translate }}
          </label>
          <input 
            class="w-full h-2 bg-surface-dark/20 dark:bg-surface-dark rounded-lg appearance-none cursor-pointer accent-primary"
            id="price"
            type="range"
            min="0"
            max="200"
            [value]="filters().priceRange"
            (input)="onPriceRangeChange(+$any($event.target).value)"/>
          <div class="flex justify-between text-xs text-subtle-light dark:text-subtle-dark mt-1">
            <span>$0</span>
            <span>{{ priceRangeDisplay() }}</span>
          </div>
        </div>

        <!-- Rating Filter -->
        <div>
          <label 
            class="block text-sm font-medium text-subtle-light dark:text-subtle-dark mb-2" 
            for="rating">
            {{ 'court-search.min-rating' | translate }}
          </label>
          <div class="flex items-center gap-2">
            <input 
              class="w-full h-2 bg-surface-dark/20 dark:bg-surface-dark rounded-lg appearance-none cursor-pointer accent-primary"
              id="rating"
              type="range"
              min="0"
              max="5"
              step="0.5"
              [value]="filters().minRating"
              (input)="onRatingChange(+$any($event.target).value)"/>
            <span class="font-bold text-sm">{{ ratingDisplay() }}</span>
          </div>
        </div>

        <!-- Apply Filters Button -->
        <button 
          class="w-full bg-primary text-white font-bold h-12 rounded-lg hover:bg-primary/90 transition-colors"
          (click)="onApplyFilters()">
          {{ 'court-search.apply-filters' | translate }}
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <div class="lg:col-span-3">
      <!-- Search Bar -->
      <div class="mb-6">
        <div class="relative">
          <input 
            class="w-full bg-surface-light dark:bg-surface-dark border border-surface-dark/10 dark:border-surface-dark rounded-lg h-14 pl-12 pr-4 focus:ring-primary focus:border-primary"
            type="search"
            [value]="searchQuery()"
            (input)="onSearchChange($any($event.target).value)"
            [placeholder]="'court-search.search-placeholder' | translate"/>
          <span class="material-symbols-outlined absolute left-4 top-1/2 -translate-y-1/2 text-subtle-light dark:text-subtle-dark">
            search
          </span>
        </div>
      </div>

      <!-- Header with Sort Options -->
      <div class="flex flex-wrap items-center justify-between gap-4 mb-6">
        <h2 class="text-2xl font-bold">{{ 'court-search.available-courts' | translate }}</h2>
        <div class="flex items-center gap-2 text-sm">
          <span class="text-subtle-light dark:text-subtle-dark">{{ 'court-search.sort-by' | translate }}</span>
          <button 
            class="px-3 py-1 rounded-full font-medium transition-colors"
            [class]="sortBy() === 'relevance' ? 'bg-primary/20 text-primary' : 'hover:bg-primary/20 hover:text-primary'"
            (click)="onSortChange('relevance')">
            {{ 'court-search.sort-relevance' | translate }}
          </button>
          <button 
            class="px-3 py-1 rounded-full font-medium transition-colors"
            [class]="sortBy() === 'price' ? 'bg-primary/20 text-primary' : 'hover:bg-primary/20 hover:text-primary'"
            (click)="onSortChange('price')">
            {{ 'court-search.sort-price' | translate }}
          </button>
          <button 
            class="px-3 py-1 rounded-full font-medium transition-colors"
            [class]="sortBy() === 'rating' ? 'bg-primary/20 text-primary' : 'hover:bg-primary/20 hover:text-primary'"
            (click)="onSortChange('rating')">
            {{ 'court-search.sort-rating' | translate }}
          </button>
        </div>
      </div>

      <!-- Courts Grid -->
      @if (isLoading()) {
        <div class="col-span-full text-center py-12">
          <div class="text-subtle-light dark:text-subtle-dark mb-4">
            <span class="material-symbols-outlined text-6xl animate-spin">refresh</span>
          </div>
          <h3 class="text-xl font-semibold mb-2">{{ 'court-search.loading' | translate }}</h3>
        </div>
      } @else {
        <div class="grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-6">
          @for (court of filteredCourts(); track court.id) {
            <div 
              class="bg-surface-light dark:bg-surface-dark rounded-lg overflow-hidden group cursor-pointer transform transition-all duration-300 hover:scale-105 hover:shadow-lg"
              (click)="onCourtClick(court)">
              <div class="relative">
                <img 
                  [alt]="court.name"
                  class="w-full h-48 object-cover group-hover:scale-105 transition-transform duration-300"
                  [src]="court.images[0]"/>
                <div class="absolute top-2 right-2 bg-primary/80 backdrop-blur-sm text-white text-xs font-bold px-2 py-1 rounded-full">
                  ${{ court.price }}/hr
                </div>
              </div>
              <div class="p-4">
                <h3 class="font-bold text-lg">{{ court.name }}</h3>
                <p class="text-sm text-subtle-light dark:text-subtle-dark mb-2">{{ court.location }}</p>
                <div class="flex items-center gap-1 text-yellow-500">
                  @for (star of getStarArray(court.rating); track $index) {
                    @if (star.filled) {
                      <span class="material-symbols-outlined !text-base">star</span>
                    } @else if (star.half) {
                      <span class="material-symbols-outlined !text-base">star_half</span>
                    } @else {
                      <span class="material-symbols-outlined !text-base text-text-light/30 dark:text-text-dark/30">star</span>
                    }
                  }
                  <span class="text-text-light dark:text-text-dark text-sm ml-1">{{ court.rating }}</span>
                </div>
              </div>
            </div>
          } @empty {
            <div class="col-span-full text-center py-12">
              <div class="text-subtle-light dark:text-subtle-dark mb-4">
                <span class="material-symbols-outlined text-6xl">search_off</span>
              </div>
              <h3 class="text-xl font-semibold mb-2">{{ 'court-search.no-results' | translate }}</h3>
              <p class="text-subtle-light dark:text-subtle-dark">
                {{ 'court-search.try-different-filters' | translate }}
              </p>
            </div>
          }
        </div>
      }
    </div>
  </div>
</div>
